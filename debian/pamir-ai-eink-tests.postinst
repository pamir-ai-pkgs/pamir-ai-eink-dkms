#!/bin/sh
set -e

case "$1" in
configure)
	# Create symlinks in /usr/bin for easy access
	if [ -d /usr/lib/pamir-ai-eink-tests/bin ]; then
		for prog in /usr/lib/pamir-ai-eink-tests/bin/*; do
			if [ -f "$prog" ] && [ -x "$prog" ]; then
				basename=$(basename "$prog")
				ln -sf "$prog" "/usr/bin/pamir-eink-$basename" 2>/dev/null || true
			fi
		done
	fi

	echo ""
	echo "E-Ink test programs installed to /usr/lib/pamir-ai-eink-tests/"
	echo ""
	echo "Available commands (installed to /usr/bin):"

	# List Python programs
	for prog in demo weather reader recovery image gif; do
		cmd="pamir-eink-eink_$prog"
		[ "$prog" = "gif" ] && cmd="pamir-eink-gif"
		if [ -x "/usr/bin/$cmd" ]; then
			case $prog in
			demo) echo "  $cmd        - Basic demonstration" ;;
			weather) echo "  $cmd     - Weather dashboard (requires API key)" ;;
			reader) echo "  $cmd      - E-book reader" ;;
			recovery) echo "  $cmd    - Display recovery tool" ;;
			image) echo "  $cmd       - Display any image format (PNG, JPEG, BMP, etc.)" ;;
			gif) echo "  $cmd            - GIF animation player" ;;
			esac
		fi
	done

	echo ""
	echo "C source code examples available at:"
	echo "  /usr/lib/pamir-ai-eink-tests/examples/"
	echo ""
	echo "To compile C examples manually:"
	echo "  cd /usr/lib/pamir-ai-eink-tests/examples"
	echo "  make"
	echo ""
	echo "To use the test programs, ensure your user is in the video group:"
	echo "  sudo usermod -a -G video \$USER"
	echo ""
	;;

abort-upgrade | abort-remove | abort-deconfigure) ;;

*)
	echo "postinst called with unknown argument \`$1'" >&2
	exit 1
	;;
esac

#DEBHELPER#

exit 0
